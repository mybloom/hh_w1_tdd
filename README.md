# 1주차 TDD 

## ℹ️ 과제 필수 사항

- Nest.js 의 경우 Typescript , Spring 의 경우 Kotlin / Java 중 하나로 작성합니다.
    - 프로젝트에 첨부된 설정 파일은 수정하지 않도록 합니다.
- 테스트 케이스의 작성 및 작성 이유를 주석으로 작성하도록 합니다.
- 프로젝트 내의 주석을 참고하여 필요한 기능을 작성해주세요.
- 분산 환경은 고려하지 않습니다.

### STEP01`기본과제`

- 포인트 충전, 사용에 대한 정책 추가 (잔고 부족, 최대 잔고 등)
- 동시에 여러 요청이 들어오더라도 순서대로 (혹은 한번에 하나의 요청씩만) 제어될 수 있도록 리팩토링
- 동시성 제어에 대한 통합 테스트 작성

#### ❓ [과제] `point` 패키지의 TODO 와 테스트코드를 작성해주세요.

**요구 사항**
- PATCH  `/point/{id}/charge` : 포인트를 충전한다.
- PATCH `/point/{id}/use` : 포인트를 사용한다.
- *GET `/point/{id}` : 포인트를 조회한다.*
- *GET `/point/{id}/histories` : 포인트 내역을 조회한다.*
- *잔고가 부족할 경우, 포인트 사용은 실패하여야 합니다.*
- *동시에 여러 건의 포인트 충전, 이용 요청이 들어올 경우 순차적으로 처리되어야 합니다.*


---

## 요구사항 분석

### 포인트 충전
- 각 포인트 충전은 최소 1부터 최대 10_000인 자연수이다.
- 포인트 충전 처리 후에 히스토리를 남긴다.

### 포인트 사용
- 잔고 부족    
    - 사용할 포인트가 보유포인트보다 큰 경우 (pointsToUse > availablePoints)
- 잔고 부족할 경우
    - 포인트 사용 실패
- 포인트 사용 처리 후에 히스토리를 남긴다.

### 포인트 조회
- 총 포인트 조회

### 포인트 내역 조회
- 포인트 충전/사용 내역 조회
    - 일자, 사유, 포인트 금액

## 동시성 처리
- 동시에 여러 건의 포인트 충전/사용/조회
    - 한 사용자의 경우, 요청 순서대로 순차적으로 처리
    - 각 사용자의 경우, 병렬 처리

---

## 동시성 제어 방식에 대한 분석 및 보고서 
https://jeongeunn.notion.site/16160fab932a80b5827fe16f2367b7cd?pvs=4 